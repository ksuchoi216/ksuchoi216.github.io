---
title: Stationary
parent: Time Series Forecasting
nav_order: 1
---

시계열 분석 및 예측에 기초 중 기초, 정상성에 대해 알아봅시다.
이 글을 읽는다면 아래 내용을 얻어가게 됩니다.

- 정상성이 무엇인지 그리고 왜 필요한지
- 어떻게 정상성을 확인 할 수 있는지
- 정상성인 데이터를 비정상성으로 만드는 법

<!--more-->

들어가기 전에, 새로운 용어가 나왔을 때는 어원이나 한자를 보는게 이해에 도움이 됩니다.
한자로는 정할 정에 항상 항을 항상 변하지 않는다(영어로는 station 머물러 있는 느낌)라고 이해하면 쉽습니다.

## 1. 정상성

**정상성(Stationary)이란?**
먼저 결론부터 말하겠습니다. **시간에 영향 받지 않는 시계열(정상성)은 예측**이 불가능합니다.

**정상성은 과거 시간에 영향 받지 않음을 나타내는 통계량**입니다. 현재가 과거 시간에 영향을 받는지는 시계열 예측에 있어 중요합니다. 왜냐하면 시계열 예측은 과거의 패턴이 현재에도 유지되어 동일하거나 비슷하게 나타난다라고 가정을 하기 때문입니다.

예를 들면, 내년도 소비 패턴을 예측한다면, 과거 소비 패턴이 내년에도 영향을 미쳐야 예측이 가능할 것이다. 반대로 말하면 과거 소비 패턴이 미래와 상관없다면 미래 예측 자체가 불가능합니다.

또 다른 예시를 들자면, 여름에 증가하고 봄 가을에 줄어드는 전기 사용량을 보면 1년을 주기로 반복되는 계절성(Seasonality)이 있기에 정상성이지 않으며 시계열 예측을 할 수 있습니다.

반대로 노이즈는 어떠합니까? 노이즈는 어느 시간 대나 랜덤하게 일정합니다. 내가 하루 전에 노이즈가 오늘 노이즈에 영향을 주지 않습니다. 그래서 노이즈는 정상성이라고 말할 수 있습니다.

다시 처음으로 돌아가자면 **비정상성**이라는 말은 쉽게 말해 노이즈가 아니고 과거로 부터 미래를 예측 가능한 시계열 데이터라는 말이라고 할 수도 있습니다.


아래는 주식, 집값, 맥주 생산량등 여러 그래프 예시입니다.
![graphs.png](/images/stationary/graphs.png){:, .align-center}


이 중에 정상성 그래프는 (d) 미국 집 판매량 그래프입니다. 딱 봐도 불규칙적인걸 볼 수 있는 정상성인 그래프입니다.

  

**Q) 정상성이 왜 중요한가요?**
여기까지 잘 읽고 이해했다면, 이 질문에 쉽게 답변할 수 있을 것입니다. 답은 미래에 예측 가능한 시계열 데이터인가를 판별할 수 있기 때문입니다. 랜덤 노이즈(정상성)를 예측할 수 있습니까? 당연히 NO입니다.

그렇다면 직관적인 판단 말고 어떻게 정상성을 확인 할 수 있을까요?

위에서 보았던 구글 주가 종가의 연도별 그래프, 연도별 그래프의 차분 그래프(차분에 대한 설명은 나중에 합니다)입니다.

![auto_correlation.png](/images/stationary/auto_correlation.png){:, .align-center}
  

ACF(Auto-correlation Function) plot과 PACF(Partial Auto-Correlation Function) plot을 보고 확인하면 됩니다. 시간 별 correlation을 구해 시간 간격 간에 상관이 있는지 알 수 있습니다. 즉 과거 시간에 현재가 영향받는지(상관이 있는지)를 알 수 있기에 정상성 판단이 가능합니다. 위에 두 그래프를 각각 ACF plot을 그려보면 아래와 같습니다.

![diff.png](/images/stationary/diff.png){:, .align-center}

왼쪽은 정상성 시계열 데이터이며, 오른쪽은 정상성이 아닌 시계열 데이터입니다. 자세히 설명하자면, 파란색 영역이 p-value 0.05(95%)이하를 나타낸다. 즉, 왼쪽 그래프는 파란색 영역이 넘어가므로 정상성이라고 말할 수 있습니다. 오른쪽 그래프는 차분을 구해 파란색 영역안으로 시계열 데이터를 만들었습니다. 파란색 영역 안으로 그래프가 바뀐 것을 볼 수 있습니다. 즉 정상성 시계열을 비정상성 그래프로 만들었습니다.

  
Q) **만약 정상성인 시계열 데이터를 다룬다면 어떻게 해야할까요?**
위에 답이 있습니다. 답부터 말하자면 차분(differencing)을 하면 됩니다. 차분은 정상성이 아닌(non-sationary) 시계열 데이터를 만드는 가장 쉬운 방법입니다. 위에 구글 주가 종가 그래프의 ACF 그래프를 보면 자연스럽게 알 수 있었습니다.

## 2. 지금까지 배운 것 복습!
- 정상성(시간에 따라 변화하지 않는다)인 시계열 데이터이면 예측이 가능하다.
- 만약 정상성이 확보되지 않는 시계열 데이터라면, 차분을 이용해 정상성을 확보해보자.

## 3. 참고 자료
시계열 예측에 있어 바이블인 Rob Hyndman 교수님의 책 'Forecasting principles and practice 3rd' 내용을 바탕으로 내용을 구성했습니다.
[출처는 fpp3 예제 내용을 참고했다.](https://otexts.com/fpp3/stationarity.html)

